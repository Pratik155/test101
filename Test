df['cluster_id'] = KMeans(n_clusters=np.argmin(np.diff([KMeans(n_clusters=k).fit(TfidfVectorizer(ngram_range=(1, 7)).fit_transform(df['customer_problems'])).inertia_ for k in range(1, len(df) // 2 + 1)])) + 1).fit(TfidfVectorizer(ngram_range=(1, 7)).fit_transform(df['customer_problems'])).labels_
