from pptx import Presentation
from pptx.util import Inches

# Assuming df is your DataFrame with the specified columns

# Create a PowerPoint presentation object
prs = Presentation()

# Loop through each row in the DataFrame
for index, row in df.iterrows():
    # Create a slide for each row
    slide = prs.slides.add_slide(prs.slide_layouts[5])  # Choose a layout (you can change the index as per your preference)
    
    # Access each column data and format it as needed
    conversation_id = row['Conversation_id']
    customer_id = row['customer_id']
    call_summary = row['call_summary']
    nps = row['NPS']
    pain_point = row['pain_point']
    customer_feedback = row['customer_feedback']
    
    # Create a textbox for displaying the row data
    textbox = slide.shapes.add_textbox(Inches(1), Inches(3), Inches(8), Inches(4))
    text_frame = textbox.text_frame
    
    # Set the text for the textbox
    text_frame.text = f"Conversation ID: {conversation_id}\nCustomer ID: {customer_id}\nCall Summary: {call_summary}\nNPS: {nps}\nPain Point: {pain_point}\nCustomer Feedback: {customer_feedback}"
    
    # Set text formatting as needed (e.g., font size, color, etc.)
    for paragraph in text_frame.paragraphs:
        for run in paragraph.runs:
            run.font.size = Inches(0.2)  # Adjust font size as needed

# Save the presentation
prs.save('dataframe_slides.pptx')
